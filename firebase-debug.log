[debug] [2021-06-09T02:39:20.099Z] ----------------------------------------------------------------------
[debug] [2021-06-09T02:39:20.100Z] Command:       /usr/local/bin/node /usr/local/bin/firebase deploy
[debug] [2021-06-09T02:39:20.100Z] CLI Version:   9.12.0
[debug] [2021-06-09T02:39:20.100Z] Platform:      darwin
[debug] [2021-06-09T02:39:20.100Z] Node Version:  v12.14.1
[debug] [2021-06-09T02:39:20.101Z] Time:          Tue Jun 08 2021 19:39:20 GMT-0700 (Pacific Daylight Time)
[debug] [2021-06-09T02:39:20.101Z] ----------------------------------------------------------------------
[debug] 
[debug] [2021-06-09T02:39:20.107Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2021-06-09T02:39:20.107Z] > authorizing via signed-in user (redflairmultimedia@gmail.com)
[debug] [2021-06-09T02:39:20.108Z] [iam] checking project active-rides-602d0 for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get","firebasedatabase.instances.update","firebasehosting.sites.update","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2021-06-09T02:39:20.110Z] > refreshing access token with scopes: ["email","https://www.googleapis.com/auth/cloud-platform","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","openid"]
[debug] [2021-06-09T02:39:20.110Z] >>> HTTP REQUEST POST https://www.googleapis.com/oauth2/v3/token  
 <request body omitted>
[debug] [2021-06-09T02:39:21.084Z] <<< HTTP RESPONSE 200 {"expires":"Mon, 01 Jan 1990 00:00:00 GMT","cache-control":"no-cache, no-store, max-age=0, must-revalidate","pragma":"no-cache","date":"Wed, 09 Jun 2021 02:39:20 GMT","content-type":"application/json; charset=utf-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","server":"scaffolding on HTTPServer2","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[debug] [2021-06-09T02:39:23.098Z] >>> HTTP REQUEST POST https://cloudresourcemanager.googleapis.com/v1/projects/active-rides-602d0:testIamPermissions  
 {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get","firebasedatabase.instances.update","firebasehosting.sites.update","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2021-06-09T02:39:41.930Z] [iam] error while checking permissions, command may fail: FirebaseError: Server Error. socket hang up
[debug] [2021-06-09T02:39:41.931Z] >>> HTTP REQUEST POST https://iam.googleapis.com/v1/projects/active-rides-602d0/serviceAccounts/active-rides-602d0@appspot.gserviceaccount.com:testIamPermissions  
 {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2021-06-09T02:39:45.174Z] <<< HTTP RESPONSE 200 {"content-type":"application/json; charset=UTF-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","date":"Wed, 09 Jun 2021 02:39:43 GMT","server":"ESF","cache-control":"private","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[debug] [2021-06-09T02:39:45.177Z] > refreshing access token with scopes: []
[debug] [2021-06-09T02:39:45.177Z] >>> HTTP REQUEST POST https://www.googleapis.com/oauth2/v3/token  
 <request body omitted>
[debug] [2021-06-09T02:39:49.211Z] <<< HTTP RESPONSE 200 {"date":"Wed, 09 Jun 2021 02:39:49 GMT","pragma":"no-cache","expires":"Mon, 01 Jan 1990 00:00:00 GMT","cache-control":"no-cache, no-store, max-age=0, must-revalidate","content-type":"application/json; charset=utf-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","server":"scaffolding on HTTPServer2","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[debug] [2021-06-09T02:39:51.257Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/active-rides-602d0 [none]
[debug] [2021-06-09T02:39:59.971Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/active-rides-602d0 200
[debug] [2021-06-09T02:39:59.971Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/active-rides-602d0 {"projectId":"active-rides-602d0","projectNumber":"138574804358","displayName":"Active Rides","name":"projects/active-rides-602d0","resources":{"hostingSite":"active-rides-602d0","realtimeDatabaseInstance":"active-rides-602d0-default-rtdb","storageBucket":"active-rides-602d0.appspot.com","locationId":"us-central"},"state":"ACTIVE"}
[debug] [2021-06-09T02:39:59.972Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/active-rides-602d0 [none]
[debug] [2021-06-09T02:40:01.108Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/active-rides-602d0 200
[debug] [2021-06-09T02:40:01.108Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/active-rides-602d0 {"projectId":"active-rides-602d0","projectNumber":"138574804358","displayName":"Active Rides","name":"projects/active-rides-602d0","resources":{"hostingSite":"active-rides-602d0","realtimeDatabaseInstance":"active-rides-602d0-default-rtdb","storageBucket":"active-rides-602d0.appspot.com","locationId":"us-central"},"state":"ACTIVE"}
[info] 
[info] === Deploying to 'active-rides-602d0'...
[info] 
[info] i  deploying database, storage, functions, hosting 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] ✔  functions: Finished running predeploy script. 
[info] i  database: checking rules syntax... 
[debug] [2021-06-09T02:40:12.106Z] > refreshing access token with scopes: ["email","https://www.googleapis.com/auth/cloud-platform","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","openid"]
[debug] [2021-06-09T02:40:12.107Z] >>> HTTP REQUEST POST https://www.googleapis.com/oauth2/v3/token  
 <request body omitted>
[debug] [2021-06-09T02:40:15.799Z] <<< HTTP RESPONSE 200 {"date":"Wed, 09 Jun 2021 02:40:15 GMT","pragma":"no-cache","cache-control":"no-cache, no-store, max-age=0, must-revalidate","expires":"Mon, 01 Jan 1990 00:00:00 GMT","content-type":"application/json; charset=utf-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","server":"scaffolding on HTTPServer2","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[debug] [2021-06-09T02:40:17.818Z] >>> HTTP REQUEST GET https://firebasedatabase.googleapis.com/v1beta/projects/active-rides-602d0/locations/-/instances/active-rides-602d0-default-rtdb  
 
[debug] [2021-06-09T02:40:19.351Z] <<< HTTP RESPONSE 200 {"content-type":"application/json; charset=UTF-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","date":"Wed, 09 Jun 2021 02:40:19 GMT","server":"ESF","cache-control":"private","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[debug] [2021-06-09T02:40:19.353Z] >>> HTTP REQUEST PUT https://active-rides-602d0-default-rtdb.firebaseio.com/.settings/rules.json?dryRun=true  
 {
    "rules": {
        "cancel_reason": {
            ".read": "auth != null",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin'"
        },
        "notifications": {
            ".read": "root.child('users').child(auth.uid).child('usertype').val() === 'admin'",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin'"
        },
        "settings": {
            ".read": "true",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin'"
        },
        "offers": {
            ".read": "auth != null",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin' || root.child('users').child(auth.uid).child('usertype').val() === 'rider'"
        },
        "rates": {
            ".read": "true",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin'"
        },
        "chats": {
            ".read": "auth != null",
            "$bookingid": {
                ".write": "root.child('bookings').child($bookingid).child('customer').val()===auth.uid || root.child('bookings').child($bookingid).child('driver').val()===auth.uid",
                "messages": {
                    "$uid": {
                        ".write": "$uid === auth.uid",
                        "$mid": {
                            ".write": "newData.child('from').val() === auth.uid"
                        }
                    }
                }
            }
        },
        "users": {
            ".read": "auth != null",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin' || root.child('users').child(auth.uid).child('usertype').val() === 'fleetadmin'",
            "$uid": {
                ".write": "auth != null && auth.uid===$uid",
                "$usernode": {
                    ".write": "$usernode==='walletBalance' || $usernode==='walletHistory' || $usernode==='approved' || $usernode==='ratings' || $usernode==='location' || $usernode==='driverActiveStatus' || $usernode==='queue' || $usernode==='savedAddresses'"
                }
            },
            ".indexOn": [
                "queue",
                "referralId",
                "fleetadmin"
            ]
        },
        "contacts": {
            ".read":true,
            ".write":true
        },
        "withdraws": {
            ".read": "auth != null",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin'",
            "$withdrawid": {
                ".write": "newData.child('uid').val()===auth.uid",
            }
        },
        "bookings": {
            ".read": "auth != null",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin'",
            "$bookingid": {
                ".write": "newData.child('customer').val()===auth.uid || newData.child('driver').val()===auth.uid || root.child('bookings').child($bookingid).child('requestedDrivers').child(auth.uid).val()===true",
            },
            ".indexOn": [
                "status",
                "customer",
                "driver",
                "requestedDrivers",
                "fleetadmin"
            ]
        },
        "tracking": {
            ".read": "auth != null",
            ".write": "root.child('users').child(auth.uid).child('usertype').val() === 'admin'",
            "$bookingid": {
                ".write": "root.child('bookings').child($bookingid).child('driver').val()===auth.uid"
            },
            ".indexOn": [
                "status",
                "customer",
                "driver"
            ]
        }
    }
}
[debug] [2021-06-09T02:40:31.116Z] <<< HTTP RESPONSE 200 {"server":"nginx","date":"Wed, 09 Jun 2021 02:40:28 GMT","content-type":"application/json; charset=utf-8","content-length":"15","connection":"keep-alive","access-control-allow-origin":"*","cache-control":"no-cache","strict-transport-security":"max-age=31556926; includeSubDomains; preload"}
[info] ✔  database: rules syntax for database active-rides-602d0-default-rtdb is valid 
[debug] [2021-06-09T02:40:31.117Z] >>> HTTP REQUEST GET https://appengine.googleapis.com/v1/apps/active-rides-602d0  
 
[debug] [2021-06-09T02:40:37.973Z] <<< HTTP RESPONSE 200 {"content-type":"application/json; charset=UTF-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","date":"Wed, 09 Jun 2021 02:40:37 GMT","server":"ESF","cache-control":"private","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2021-06-09T02:40:37.975Z] >>> HTTP REQUEST POST https://firebaserules.googleapis.com/v1/projects/active-rides-602d0:test  
 {"source":{"files":[{"name":"storage.rules","content":"rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    match /{allPaths=**} {\n    allow read, write;\n    }\n  }\n}\n"}]}}
[debug] [2021-06-09T02:40:44.608Z] <<< HTTP RESPONSE 200 {"content-type":"application/json; charset=UTF-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","date":"Wed, 09 Jun 2021 02:40:44 GMT","server":"ESF","cache-control":"private","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2021-06-09T02:40:46.830Z] >>> HTTP REQUEST GET https://serviceusage.googleapis.com/v1/projects/active-rides-602d0/services/cloudfunctions.googleapis.com  
 
[debug] [2021-06-09T02:40:46.830Z] >>> HTTP REQUEST GET https://serviceusage.googleapis.com/v1/projects/active-rides-602d0/services/runtimeconfig.googleapis.com  
 
[debug] [2021-06-09T02:40:46.830Z] >>> HTTP REQUEST GET https://serviceusage.googleapis.com/v1/projects/active-rides-602d0/services/cloudbuild.googleapis.com  
 
[debug] [2021-06-09T02:41:22.930Z] <<< HTTP RESPONSE 200 {"content-type":"application/json; charset=UTF-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","date":"Wed, 09 Jun 2021 02:40:56 GMT","server":"ESF","cache-control":"private","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[debug] [2021-06-09T02:41:23.075Z] <<< HTTP RESPONSE 200 {"content-type":"application/json; charset=UTF-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","date":"Wed, 09 Jun 2021 02:40:56 GMT","server":"ESF","cache-control":"private","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2021-06-09T02:41:23.735Z] Error: socket hang up
    at connResetException (internal/errors.js:570:14)
    at TLSSocket.socketOnEnd (_http_client.js:440:23)
    at TLSSocket.emit (events.js:228:7)
    at TLSSocket.EventEmitter.emit (domain.js:475:20)
    at endReadableNT (_stream_readable.js:1185:12)
    at processTicksAndRejections (internal/process/task_queues.js:81:21)
[error] 
[error] Error: Server Error. socket hang up
[debug] [2021-06-09T02:43:54.980Z] ----------------------------------------------------------------------
[debug] [2021-06-09T02:43:54.981Z] Command:       /usr/local/bin/node /usr/local/bin/firebase deploy
[debug] [2021-06-09T02:43:54.981Z] CLI Version:   9.12.0
[debug] [2021-06-09T02:43:54.981Z] Platform:      darwin
[debug] [2021-06-09T02:43:54.981Z] Node Version:  v12.14.1
[debug] [2021-06-09T02:43:54.982Z] Time:          Tue Jun 08 2021 19:43:54 GMT-0700 (Pacific Daylight Time)
[debug] [2021-06-09T02:43:54.982Z] ----------------------------------------------------------------------
[debug] 
[debug] [2021-06-09T02:43:54.988Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2021-06-09T02:43:54.988Z] > authorizing via signed-in user (redflairmultimedia@gmail.com)
[debug] [2021-06-09T02:43:54.988Z] [iam] checking project active-rides-602d0 for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get","firebasedatabase.instances.update","firebasehosting.sites.update","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2021-06-09T02:43:54.990Z] >>> HTTP REQUEST POST https://cloudresourcemanager.googleapis.com/v1/projects/active-rides-602d0:testIamPermissions  
 {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get","firebasedatabase.instances.update","firebasehosting.sites.update","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2021-06-09T02:44:11.323Z] <<< HTTP RESPONSE 200 {"content-type":"application/json; charset=UTF-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","date":"Wed, 09 Jun 2021 02:44:10 GMT","server":"ESF","cache-control":"private","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","server-timing":"gfet4t7; dur=768","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[debug] [2021-06-09T02:44:11.324Z] >>> HTTP REQUEST POST https://iam.googleapis.com/v1/projects/active-rides-602d0/serviceAccounts/active-rides-602d0@appspot.gserviceaccount.com:testIamPermissions  
 {"permissions":["iam.serviceAccounts.actAs"]}
